var P=({prefix:r="pdm",modes:E=["light","dark"]}={})=>{let n=r,l=window.localStorage,t=E,c=new Set,h=e=>{t=e,c.forEach(o=>o(e))},w={subscribe(e){return e(t),c.add(e),()=>c.delete(e)},set:h,update(e){h(e(t))}},u=new Set,a=matchMedia("(prefers-color-scheme: dark)"),m,f=({matches:e})=>{m=e?"dark":"light",u.forEach(o=>o(m))};a.addEventListener?a.addEventListener("change",f):a.addListener(f),f(a);let v={subscribe(e){return e(m),u.add(e),()=>u.delete(e)}},O=e=>{if(!(!e||!t.includes(e)))return e},M=new Set,s=O(l.getItem(n)),p=(e,o=!0)=>{e!==s&&(o&&(e!==void 0?l.setItem(n,e):l.removeItem(n)),M.forEach(T=>T(e)),s=e)};window.addEventListener("storage",e=>e.key===n&&p(e.newValue||void 0,!1));let i={subscribe(e){return e(s),M.add(e),()=>M.delete(e)},set:p,update(e){p(e(s))}},g,x,d,b=new Set,W=()=>{let e=g||x;e!==d&&(d=e,b.forEach(o=>o(d)))};i.subscribe(e=>{g=e,W()}),v.subscribe(e=>{x=e,W()});let k={subscribe(e){return e(d),b.add(e),()=>b.delete(e)},set:i.set,update(e){let o=t.indexOf(d);o=o===-1?0:o,i.set(e(d,t,o))}},C=document.documentElement.classList,S;return k.subscribe(e=>{S&&C.remove(`${r}-${S}`),C.add(`${r}-${e}`),S=e}),C.add(r),{mode:k,modes:w,modeOS:v,modeSaved:i}};export{P as createPerfectDarkMode};
